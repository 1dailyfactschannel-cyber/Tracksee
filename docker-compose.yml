version: '3.8'

services:
  # Next.js Application only
  app:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: tracksee-app
    restart: unless-stopped
    environment:
      # Database - Укажите полный URL к существующей базе данных
      # Формат: postgres://user:password@host:port/database
      # Примеры:
      # - База в другом контейнере: postgres://postgres:D2rGkB6CaIwpb@имя_контейнера_бд:5432/tracksee
      # - База на хосте: postgres://postgres:D2rGkB6CaIwpb@host.docker.internal:5432/tracksee
      # - База по IP: postgres://postgres:D2rGkB6CaIwpb@192.168.1.100:5432/tracksee
      DATABASE_URL: ${DATABASE_URL}
      
      # NextAuth Configuration
      NEXTAUTH_SECRET: ${NEXTAUTH_SECRET:-asdasdLskksak111LLS}
      NEXTAUTH_URL: ${NEXTAUTH_URL:-http://89.208.14.253:5440}
      
      # App Configuration
      NODE_ENV: production
      PORT: 3000
    ports:
      - "5440:3000"
    # Если база данных в той же Docker сети, добавьте:
    # networks:
    #   - сеть_вашей_базы_данных
    volumes:
      - app_logs:/app/logs

volumes:
  app_logs:
    driver: local

# Если нужно подключиться к существующей сети базы данных:
# networks:
#   сеть_вашей_базы_данных:
#     external: true
